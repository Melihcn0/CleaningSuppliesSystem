@model UpdateAdminProfileDto

<form id="updateAdminProfileForm" method="post" asp-area="Admin" asp-controller="AdminProfile" asp-action="UpdateAdminProfile">
    <input type="hidden" asp-for="Id" />
    @Html.AntiForgeryToken()

    <div class="row">
        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="FirstName" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    Ad <span class="text-danger-600">*</span>
                </label>
                <input asp-for="FirstName" class="form-control radius-8" maxlength="50" required/>
                <span asp-validation-for="FirstName" class="text-danger"></span>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="LastName" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    Soyad <span class="text-danger-600">*</span>
                </label>
                <input asp-for="LastName" class="form-control radius-8" maxlength="50" required />
                <span asp-validation-for="LastName" class="text-danger"></span>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="UserName" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    Kullanıcı Adı <span class="text-danger-600">*</span>
                </label>
                <input asp-for="UserName"
                       class="form-control radius-8"
                       maxlength="30"
                       required
                       pattern="^[a-zA-Z0-9._-]+$"
                       title="Kullanıcı adı '@@' içeremez. Sadece harf, rakam, nokta, tire ve alt tire kullanılabilir." />
                <span asp-validation-for="UserName" class="text-danger"></span>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="Email" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    E-posta <span class="text-danger-600">*</span>
                </label>
                <input asp-for="Email" type="email" class="form-control radius-8" maxlength="100" required />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="NationalId" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    Kimlik No <span class="text-danger-600">*</span>
                </label>
                <input asp-for="NationalId" type="tel" class="form-control radius-8" minlength="11" maxlength="11" placeholder="11111111111" required />
                <span asp-validation-for="NationalId" class="text-danger"></span>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="mb-20">
                <label asp-for="PhoneNumber" class="form-label fw-semibold text-primary-light text-sm mb-8">
                    Telefon <span class="text-danger-600">*</span>
                </label>
                <input asp-for="PhoneNumber" type="tel" class="form-control radius-8" minlength="17" maxlength="17" placeholder="+90 500 400 30 20" required/>
                <span asp-validation-for="PhoneNumber" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="d-flex align-items-center justify-content-center gap-3 mt-24">
        <a href="@Url.Action("Index", "AdminProfile")" class="border border-danger-600 bg-hover-danger-200 text-danger-600 text-md px-56 py-11 radius-8">
            İptal
        </a>
        <button type="button" onclick=updateAdminProfile() id="submitButton" class="btn btn-primary border border-primary-600 text-md px-56 py-12 radius-8">
            Kaydet
        </button>
    </div>
</form>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {

            const phoneInput = document.getElementById('PhoneNumber');
            if(phoneInput) {
                phoneInput.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    if(value === '') { this.value = ''; return; }
                    if(value.startsWith('0')) value = '90' + value.slice(1);
                    else if(!value.startsWith('90')) value = '90' + value;
                    let formatted = '+' +
                        value.slice(0,2) + ' ' +
                        (value.length>2 ? value.slice(2,5)+' ' : '') +
                        (value.length>5 ? value.slice(5,8)+' ' : '') +
                        (value.length>8 ? value.slice(8,10)+' ' : '') +
                        (value.length>10 ? value.slice(10,12) : '');
                    this.value = formatted.trim();
                });
            }

            // Global scope'a taşı
            window.updateAdminProfile = function() {
                const form = document.getElementById("updateAdminProfileForm");
                const theme = document.documentElement.getAttribute("data-theme");

                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                Swal.fire({
                    title: "Profil Bilgileri",
                    text: "Değişiklikler kaydedilsin mi?",
                    icon: "question",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Evet, kaydet!",
                    cancelButtonText: "İptal",
                    background: theme === "dark" ? "#1e1e2f" : "#fff",
                    color: theme === "dark" ? "#fff" : "#000",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) form.submit();
                });
            }
        });
    </script>
}

